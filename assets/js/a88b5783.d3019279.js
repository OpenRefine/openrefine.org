"use strict";(self.webpackChunkOpenRefine_Documentation=self.webpackChunkOpenRefine_Documentation||[]).push([[5004],{8950:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>r,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var t=n(64861),s=n(69018);const a={id:"reconciling",title:"Reconciling",sidebar_label:"Reconciling"},o=void 0,c={id:"manual/reconciling",title:"Reconciling",description:"Overview",source:"@site/docs/manual/reconciling.md",sourceDirName:"manual",slug:"/manual/reconciling",permalink:"/docs/manual/reconciling",draft:!1,unlisted:!1,editUrl:"https://github.com/OpenRefine/openrefine.github.com/edit/master/docs/manual/reconciling.md",tags:[],version:"current",lastUpdatedBy:"Antonin Delpeuch",lastUpdatedAt:167298953e4,frontMatter:{id:"reconciling",title:"Reconciling",sidebar_label:"Reconciling"},sidebar:"docs",previous:{title:"Transposing",permalink:"/docs/manual/transposing"},next:{title:"Overview",permalink:"/docs/manual/wikibase/overview"}},r={},l=[{value:"Overview",id:"overview",level:2},{value:"Sources",id:"sources",level:2},{value:"Getting started",id:"getting-started",level:2},{value:"Reconciliation facets",id:"reconciliation-facets",level:3},{value:"Reconciliation actions",id:"reconciliation-actions",level:3},{value:"Reconciling with unique identifiers",id:"reconciling-with-unique-identifiers",level:2},{value:"Reconciling by type",id:"reconciling-by-type",level:2},{value:"Reconciling with additional columns",id:"reconciling-with-additional-columns",level:2},{value:"Fetching more data",id:"fetching-more-data",level:2},{value:"Add entity identifiers column",id:"add-entity-identifiers-column",level:3},{value:"Add columns from reconciled values",id:"add-columns-from-reconciled-values",level:3},{value:"Add columns by fetching URLs",id:"add-columns-by-fetching-urls",level:3},{value:"Keep all the suggestions made",id:"keep-all-the-suggestions-made",level:2},{value:"Writing reconciliation expressions",id:"writing-reconciliation-expressions",level:2},{value:"Exporting reconciled data",id:"exporting-reconciled-data",level:2}];function h(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(i.p,{children:["Reconciliation is the process of matching your dataset with that of an external source. Datasets for comparison might be produced by libraries, archives, museums, academic organizations, scientific institutions, non-profits, or interest groups. You can also reconcile against user-edited data on ",(0,t.jsx)(i.a,{href:"wikibase/reconciling",children:"Wikidata or other Wikibase instances"}),", or reconcile against ",(0,t.jsx)(i.a,{href:"https://github.com/OpenRefine/OpenRefine/wiki/Reconcilable-Data-Sources#local-services",children:"a local dataset that you yourself supply"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["To reconcile your OpenRefine project against an external dataset, that dataset must offer a web service that conforms to the ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/specs/0.1/",children:"Reconciliation Service API standards"}),"."]}),"\n",(0,t.jsx)(i.p,{children:"You may wish to reconcile in order to:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"fix spelling or variations in proper names"}),"\n",(0,t.jsxs)(i.li,{children:["clean up manually-entered subject headings against authorities such as the ",(0,t.jsx)(i.a,{href:"https://id.loc.gov/authorities/subjects.html",children:"Library of Congress Subject Headings"})," (LCSH)"]}),"\n",(0,t.jsx)(i.li,{children:"link your data to an existing dataset"}),"\n",(0,t.jsxs)(i.li,{children:["add to an editable platform such as ",(0,t.jsx)(i.a,{href:"https://www.wikidata.org",children:"Wikidata"})]}),"\n",(0,t.jsxs)(i.li,{children:["or see whether entities in your project appear in some specific list, such as the ",(0,t.jsx)(i.a,{href:"https://aleph.occrp.org/datasets/734",children:"Panama Papers"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["Reconciliation is semi-automated: OpenRefine matches your cell values to the reconciliation information as best it can, but human judgment is required to review and approve the results. Reconciling happens by default through string searching, so typos, whitespace, and extraneous characters will have an effect on the results. You may wish to ",(0,t.jsx)(i.a,{href:"cellediting",children:"clean and cluster"})," your data before reconciliaton."]}),"\n",(0,t.jsx)(i.admonition,{title:"Working iteratively",type:"info",children:(0,t.jsx)(i.p,{children:"We recommend planning your reconciliation operations as iterative: reconcile multiple times with different settings, and with different subgroups of your data."})}),"\n",(0,t.jsx)(i.h2,{id:"sources",children:"Sources"}),"\n",(0,t.jsxs)(i.p,{children:["Start with ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/testbench/",children:"this current list of reconcilable authorities"}),", which includes instructions for adding new services via Wikidata editing if you have one to add."]}),"\n",(0,t.jsxs)(i.p,{children:["OpenRefine maintains a ",(0,t.jsx)(i.a,{href:"https://github.com/OpenRefine/OpenRefine/wiki/Reconcilable-Data-Sources",children:"further list of sources on the wiki"}),", which can be edited by anyone. This list includes ways that you can reconcile against a ",(0,t.jsx)(i.a,{href:"https://github.com/OpenRefine/OpenRefine/wiki/Reconcilable-Data-Sources#local-services",children:"local dataset"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["Other services may exist that are not yet listed in these two places: for example, the ",(0,t.jsx)(i.a,{href:"https://aleph.occrp.org/datasets/",children:"310 datasets hosted by the Organized Crime and Corruption Reporting Project (OCCRP)"})," each have their own reconciliation URL, or you can reconcile against their entire database with the URL ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/testbench/",children:"shared on the reconciliation API list"}),". For another example, you can reconcile against the entire Virtual International Authority File (VIAF) dataset, or ",(0,t.jsx)(i.a,{href:"http://refine.codefork.com/",children:"only the contributions from certain institutions"}),". Search online to see if the authority you wish to reconcile against has an available service, or whether you can download a copy to reconcile against locally."]}),"\n",(0,t.jsxs)(i.p,{children:["OpenRefine includes Wikidata reconciliation in the installation package - see the ",(0,t.jsx)(i.a,{href:"wikibase/reconciling",children:"Wikibase"})," page for more information particular to that service. Extensions can add reconciliation services, and can also add enhanced reconciliation capacities. Check the list of extensions on the ",(0,t.jsx)(i.a,{href:"https://openrefine.org/download.html",children:"Downloads page"})," for more information."]}),"\n",(0,t.jsxs)(i.p,{children:["Each source will have its own documentation on how it provides reconciliation. The table on ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/testbench/",children:"the reconciliation API list"})," indicates whether your chosen service supports the features described below. Refer to the service's documentation if you have questions about its behaviors and which OpenRefine features it supports."]}),"\n",(0,t.jsxs)(i.p,{children:["In addition to the reconciliation services mentioned above, you may also choose to build your own service.  You can either start from scratch using the ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/specs/latest/",children:"API specification"})," or use one of the frameworks mentioned in the ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/census/services/",children:"Reconciliation census"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["Of particular note is ",(0,t.jsx)(i.a,{href:"http://okfnlabs.org/reconcile-csv/",children:"reconcile-csv"})," which allows you to build a reconciliation service from a simple CSV file.  Thus if you wanted to reconcile one OpenRefine project against another, you'd simply need to export the target project as a CSV, point ",(0,t.jsx)(i.code,{children:"reconcile-csv"})," at it and you're good to go.  A somewhat newer port of this project written in Python can be found at ",(0,t.jsx)(i.a,{href:"https://github.com/gitonthescene/csv-reconcile",children:"csv-reconcile"})," which is more configurable and defaults to parsing tab separated files for convenience."]}),"\n",(0,t.jsx)(i.p,{children:"Similiarly, you may choose to export some SPARQL output to a TSV to limit the scope of values you're reconciling against and/or for better peformance."}),"\n",(0,t.jsx)(i.h2,{id:"getting-started",children:"Getting started"}),"\n",(0,t.jsxs)(i.p,{children:["Choose a column to reconcile and use its dropdown menu to select ",(0,t.jsx)("span",{class:"menuItems",children:"Reconcile"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Start reconciling"}),". If you want to reconcile only some cells in that column, first use filters and facets to isolate them."]}),"\n",(0,t.jsxs)(i.p,{children:["In the reconciliation window, you will see Wikidata offered as a default service. To add another service, click ",(0,t.jsx)("span",{class:"buttonLabels",children:"Add Standard Service..."})," and paste in the URL of a ",(0,t.jsx)(i.a,{href:"#sources",children:"service"}),". You should see the name of the service appear in the list of ",(0,t.jsx)("span",{class:"buttonLabels",children:"Services"})," if the URL is correct."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"The reconciliation window.",src:n(17197).Z+""})}),"\n",(0,t.jsxs)(i.p,{children:["Once you select a service, your selected column may be sampled in order to suggest ",(0,t.jsx)(i.a,{href:"#reconciling-by-type",children:"\u201ctypes\u201d (categories)"})," to reconcile against. Other services will suggest their available types without sampling, and some services have no types."]}),"\n",(0,t.jsxs)(i.p,{children:["For example, if you had a list of artists represented in a gallery collection, you could reconcile their names against the Getty Research Institute\u2019s ",(0,t.jsx)(i.a,{href:"https://www.getty.edu/research/tools/vocabularies/ulan/",children:"Union List of Artist Names (ULAN)"}),". The same ",(0,t.jsx)(i.a,{href:"https://services.getty.edu/vocab/reconcile/",children:"Getty reconciliation URL"})," will offer you ULAN, AAT (Art and Architecture Thesaurus), and TGN (Thesaurus of Geographic Names)."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"The reconciliation window with types.",src:n(30089).Z+""})}),"\n",(0,t.jsxs)(i.p,{children:["Refer to the ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/testbench/",children:"documentation specific to the reconciliation service"})," to learn whether types are offered, which types are offered, and which one is most appropriate for your column. You may wish to facet your data and reconcile batches against different types if available."]}),"\n",(0,t.jsx)(i.p,{children:"Reconciliation can be a time-consuming process, especially with large datasets. We suggest starting with a small test batch. There is no throttle (delay between requests) to set for the reconciliation process. The amount of time will vary for each service, and vary based on the options you select during the process."}),"\n",(0,t.jsx)(i.p,{children:"When the process is done, you will see the reconciliation data in the cells.\nIf the cell was successfully matched, it displays text as a single dark blue link. In this case, the reconciliation is confident that the match is correct, and you should not have to check it manually.\nIf there is no clear match, one or more candidates are displayed, together with their reconciliation score, with the text in light blue links. You will need to select the correct one."}),"\n",(0,t.jsx)(i.p,{children:"For each matching decision you make, you have two options: match this cell only (one checkmark), or also use the same identifier for all other cells containing the same original string (two checkmarks)."}),"\n",(0,t.jsxs)(i.p,{children:["For services that offer the ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/testbench/",children:"\u201cpreview entities\u201d feature"}),", you can hover your mouse over the suggestions to see more information about the candidates or matches. Each participating service (and each type) will deliver different structured data that may help you compare the candidates."]}),"\n",(0,t.jsx)(i.p,{children:"For example, the Getty ULAN shows an artist\u2019s discipline, nationality, and birth and death years:"}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Hovering over matches.",src:n(30867).Z+""})}),"\n",(0,t.jsx)(i.p,{children:"Hovering over the suggestion will also offer the two matching options as buttons."}),"\n",(0,t.jsxs)(i.p,{children:["For matched values (those appearing as dark blue links), the underlying cell value has not been altered - the cell is storing both the original string and the matched entity link at the same time. If you were to copy your column to a new column at this point using ",(0,t.jsx)(i.code,{children:"value"}),", for example, the reconciliation data would not transfer - only the original strings. You can learn more about how OpenRefine stores different pieces of information in each cell in ",(0,t.jsx)(i.a,{href:"expressions#reconciliation",children:"the Variables section specific to reconciliation data"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["For each cell, you can manually \u201cCreate new item,\u201d which will take the cell\u2019s original value and apply it, as though it is a match. This will not become a dark blue link, because at this time there is nothing to link to: it is a draft entity stored only in your project. You can use this feature to prepare these entries for eventual upload to an editable service such as ",(0,t.jsx)(i.a,{href:"wikibase/overview",children:"Wikibase"}),", but most services do not yet support this feature."]}),"\n",(0,t.jsx)(i.h3,{id:"reconciliation-facets",children:"Reconciliation facets"}),"\n",(0,t.jsxs)(i.p,{children:["Under ",(0,t.jsx)("span",{class:"menuItems",children:"Reconcile"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Facets"})," there are a number of reconciliation-specific faceting options. OpenRefine automatically creates two facets when you reconcile some cells."]}),"\n",(0,t.jsxs)(i.p,{children:["One is a numeric facet for \u201cbest candidate's score,\u201d the range of reconciliation scores of only the best candidate of each cell. Higher scores mean better matches, although each service calculates scores differently and has a different range. You can facet for higher scores using the numeric facet, and then approve them all in bulk, by using ",(0,t.jsx)("span",{class:"menuItems",children:"Reconcile"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:(0,t.jsx)(i.a,{href:"#reconciliation-actions",children:"Actions"})})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Match each cell to its best candidate"}),"."]}),"\n",(0,t.jsx)(i.p,{children:"There is also a \u201cjudgment\u201d facet created, which lets you filter for the cells that haven't been matched (pick \u201cnone\u201d in the facet). As you process each cell, its judgment changes from \u201cnone\u201d to \u201cmatched\u201d and it disappears from the view."}),"\n",(0,t.jsxs)(i.p,{children:["You can add other facets by selecting ",(0,t.jsx)("span",{class:"menuItems",children:"Reconcile"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Facets"})," on your reconciled column. You can facet by:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"your judgments (\u201cmatched,\u201d or \u201cnone\u201d for unreconciled cells, or \u201cnew\u201d for entities you've created)"}),"\n",(0,t.jsx)(i.li,{children:"the action you\u2019ve performed on that cell (chosen a \u201csingle\u201d match, or set a \u201cmass\u201d match, or no action, which appears as \u201cunknown\u201d)"}),"\n",(0,t.jsx)(i.li,{children:"the timestamps on the edits you\u2019ve made so far (these appear as millisecond counts since an arbitrary point: they can be sorted alphabetically to move forward and back in time)."}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"You can facet only the best candidates for each cell, based on:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"the score (calculated based on each service's own methods)"}),"\n",(0,t.jsxs)(i.li,{children:["the edit distance (using the ",(0,t.jsx)(i.a,{href:"cellediting#nearest-neighbor",children:"Levenshtein distance"}),", a number based on how many single-character edits would be required to get your original value to the candidate value, with a larger value being a greater difference)"]}),"\n",(0,t.jsx)(i.li,{children:"the word similarity."}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["Word similarity is calculated as a percentage based on how many words (excluding ",(0,t.jsx)(i.a,{href:"https://en.wikipedia.org/wiki/Stop_word",children:"stop words"}),") in the original value match words in the candidate. For example, the value \u201cMaria Luisa Zuloaga de Tovar\u201d matched to the candidate \u201cPalacios, Luisa Zuloaga de\u201d results in a word similarity value of 0.6, or 60%, or 3 out of 5 words. Cells that are not yet matched to one candidate will show as 0.0)."]}),"\n",(0,t.jsx)(i.p,{children:"You can also look at each best candidate\u2019s:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"type (the ones you have selected in successive reconciliation attempts, or other types returned by the service based on the cell values)"}),"\n",(0,t.jsx)(i.li,{children:"type match (\u201ctrue\u201d if you selected a type and it succeeded, \u201cfalse\u201d if you reconciled against no particular type, and \u201c(no type)\u201d if it didn\u2019t reconcile)"}),"\n",(0,t.jsx)(i.li,{children:"name match (\u201ctrue\u201d if you\u2019ve matched, \u201cfalse\u201d if you haven\u2019t yet chosen from the candidates, or \u201c(unreconciled)\u201d if it didn\u2019t reconcile)."}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["These facets are useful for doing successive reconciliation attempts, against different types, and with different supplementary information. The information represented by these facets are held in the cells themselves and can be called using the ",(0,t.jsx)(i.a,{href:"expressions#reconciliation",children:"reconciliation variables"})," available in expressions."]}),"\n",(0,t.jsx)(i.h3,{id:"reconciliation-actions",children:"Reconciliation actions"}),"\n",(0,t.jsxs)(i.p,{children:["You can use the ",(0,t.jsx)("span",{class:"menuItems",children:"Reconcile"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Actions"})," menu options to perform bulk changes (which will apply only to your currently viewed set of rows or records):"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)("span",{class:"menuItems",children:"Match each cell to its best candidate"})," (by highest score)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)("span",{class:"menuItems",children:"Create a new item for each cell"})," (discard any suggested matches)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)("span",{class:"menuItems",children:"Create one new item for similar cells"})," (a new entity will be created for each unique string)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)("span",{class:"menuItems",children:"Match all filtered cells to..."})," (a specific item from the chosen service, via a search box; only works with services that support the \u201csuggest entities\u201d property)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)("span",{class:"menuItems",children:"Discard all reconciliation judgments"})," (reverts back to multiple candidates per cell, including cells that may have been auto-matched in the original reconciliation process)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)("span",{class:"menuItems",children:"Clear reconciliation data"}),", reverting all cells back to their original values."]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["The other options available under ",(0,t.jsx)("span",{class:"menuItems",children:"Reconcile"})," are:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)("span",{class:"menuItems",children:"Copy reconciliation data..."})," (to an existing column: if the original values in your reconciliation column are identical to those in your chosen column, the matched and new cells will copy over; unmatched values will not change)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.a,{href:"#reconciling-with-unique-identifiers",children:(0,t.jsx)("span",{class:"menuItems",children:"Use values as identifiers"})})," (if you are reconciling with unique identifiers instead of by doing string searches)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.a,{href:"#add-entity-identifiers-column",children:(0,t.jsx)("span",{class:"menuItems",children:"Add entity identifiers column"})}),"."]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"reconciling-with-unique-identifiers",children:"Reconciling with unique identifiers"}),"\n",(0,t.jsxs)(i.p,{children:["Reconciliation services use unique identifiers for their entities. For example, the 14th Dalai Lama has the VIAF ID ",(0,t.jsx)(i.a,{href:"https://viaf.org/viaf/38242123/",children:"38242123"})," and the Wikidata ID ",(0,t.jsx)(i.a,{href:"https://www.wikidata.org/wiki/Q37349",children:"Q17293"}),". You can supply your known identifiers in a column to immediately match with the known IDs from a reconciliation service in order to subsequently pull more data about them."]}),"\n",(0,t.jsxs)(i.p,{children:["Select the column with unique known identifiers of a service and apply the operation ",(0,t.jsx)("span",{class:"menuItems",children:"Reconcile"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Use values as identifiers"}),". If you use this operation on a column of known IDs, you will not have access to the usual reconciliation settings.  Instead, this will bring up a dialog to select a service from the list of reconciliation services you have already added (to add a new service, open the ",(0,t.jsx)("span",{class:"menuItems",children:"Start reconciling..."})," window first)."]}),"\n",(0,t.jsx)(i.admonition,{type:"info",children:(0,t.jsxs)(i.mdxAdmonitionTitle,{children:["Before running this operation, ensure that the IDs in your column ",(0,t.jsx)(i.strong,{children:"already exist"})," with the reconciliation service.  ",(0,t.jsx)("span",{class:"menuItems",children:"Use values as identifiers"}),' assumes they exist with the service, and so does not perform a lookup or "reconcile" against the service.']})}),"\n",(0,t.jsx)(i.p,{children:"This operation is typically very fast and after it completes all cells will appear as dark blue \u201cconfirmed\u201d matches."}),"\n",(0,t.jsx)(i.p,{children:"You may get false positives (ex. the IDs no longer exist with the service), which you will need to hover over or click on to identify:"}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Hovering over an error.",src:n(62739).Z+""})}),"\n",(0,t.jsx)(i.h2,{id:"reconciling-by-type",children:"Reconciling by type"}),"\n",(0,t.jsx)(i.p,{children:"Reconciliation services, once added to OpenRefine, may suggest types from their databases. These types will usually be whatever the service specializes in: people, events, places, buildings, tools, plants, animals, organizations, etc."}),"\n",(0,t.jsx)(i.p,{children:"Reconciling against a type may be faster and more accurate, but may result in fewer matches. Some services have hierarchical types (such as \u201cmammal\u201d as a subtype of \u201canimal\u201d). When you reconcile against a more specific type, unmatched values may fall back to the broader type; other services will not do this, so you may need to perform successive reconciliation attempts against different types. Refer to the documentation specific to the reconciliation service to learn more."}),"\n",(0,t.jsxs)(i.p,{children:["When you select a service from the list, OpenRefine will load some or all available types. Some services will sample the first ten rows of your column to suggest types (check the ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/testbench/",children:"\u201cSuggest types\u201d column"}),"). You will see a service\u2019s types in the reconciliation window:"]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Reconciling using a type.",src:n(78004).Z+""})}),"\n",(0,t.jsxs)(i.p,{children:["In this example, \u201cPerson\u201d and \u201cCorporate Name\u201d are potential types offered by the reconciliation API for VIAF. You can also use the ",(0,t.jsx)("span",{class:"fieldLabels",children:"Reconcile against type:"})," field to enter in another type that the service offers. When you start typing, this field may search and suggest existing types. For VIAF, you could enter \u201c/book/book\u201d if your column contained publications. You may need to enter the service's own strings precisely instead of attempting to search for a match."]}),"\n",(0,t.jsxs)(i.p,{children:["Types are structured to fit their content: the Wikidata \u201chuman\u201d type, for example, can include fields for birth and death dates, nationality, etc. The VIAF \u201cperson\u201d type can include nationality and gender. You can use this to ",(0,t.jsx)(i.a,{href:"#reconciling-with-additional-columns",children:"include more properties"})," and find better matches."]}),"\n",(0,t.jsxs)(i.p,{children:["If your column doesn\u2019t fit one specific type offered, you can ",(0,t.jsx)("span",{class:"fieldLabels",children:"Reconcile against no particular type"}),". This may take longer."]}),"\n",(0,t.jsxs)(i.p,{children:["We recommend working in batches and reconciling against different types, moving from specific to broad. You can create a facet for ",(0,t.jsx)("span",{class:"menuItems",children:"Best candidate\u2019s types"})," facet to see which types are being represented. Some candidates may return more than one type, depending on the service. Types may appear in facets by their unique IDs, rather than by their semantic labels (for example, Q5 for \u201chuman\u201d in Wikidata)."]}),"\n",(0,t.jsx)(i.h2,{id:"reconciling-with-additional-columns",children:"Reconciling with additional columns"}),"\n",(0,t.jsx)(i.p,{children:"Some of your cells may be ambiguous, in the sense that a string can point to more than one entity: there are dozens of places called \u201cParis\u201d and many characters, people, and pieces of culture, too. Selecting non-geographic or more localized types can help narrow that down, but if your chosen service doesn't provide a useful type, you can include more properties that make it clear whether you're looking for Paris, France."}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Reconciling sometimes turns up ambiguous matches.",src:n(60759).Z+""})}),"\n",(0,t.jsxs)(i.p,{children:["Including supplementary information can be useful, depending on the service (such as including birthdate information about each person you are trying to reconcile). You can re-reconcile unmatched cells with additional properties, in the right side of the ",(0,t.jsx)("span",{class:"menuItems",children:"Start reconciling"})," window, under \u201cAlso use relevant details from other columns.\u201d The column names in your project will appear in the reconciliation window, with an ",(0,t.jsx)("span",{class:"fieldLabels",children:"Include?"})," checkbox next to each one."]}),"\n",(0,t.jsxs)(i.p,{children:["Fill in the ",(0,t.jsx)("span",{class:"fieldLabels",children:"As Property"})," field with the type of information you are including. When you start typing, potential fields may pop up (depending on the ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/testbench/",children:"\u201csuggest properties\u201d feature"}),"), such as \u201cbirthDate\u201d in the case of ULAN or \u201cGeburtsdatum\u201d in the case of Integrated Authority File (GND). Use the documentation for your chosen service to identify the fields in their terms."]}),"\n",(0,t.jsxs)(i.p,{children:["Some services will not be able to search for the exact name of your desired ",(0,t.jsx)("span",{class:"fieldLabels",children:"As Property"})," entry, but you can still manually supply the field name. Refer to the service to choose the most appropriate field, and make sure you enter it correctly."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Including a birth-date type.",src:n(67371).Z+""})}),"\n",(0,t.jsx)(i.h2,{id:"fetching-more-data",children:"Fetching more data"}),"\n",(0,t.jsx)(i.p,{children:"One reason to reconcile to some external service is that it allows you to pull data from that service into your OpenRefine project. There are three ways to do this:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Add identifiers for your values"}),"\n",(0,t.jsx)(i.li,{children:"Add columns from reconciled values"}),"\n",(0,t.jsx)(i.li,{children:"Add column by fetching URLs."}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"add-entity-identifiers-column",children:"Add entity identifiers column"}),"\n",(0,t.jsxs)(i.p,{children:["Once you have selected matches for your cells, you can retrieve the unique identifiers for those cells and create a new column for these, with ",(0,t.jsx)("span",{class:"menuItems",children:"Reconcile"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Add entity identifiers column"}),". You will be asked to supply a column name. New items and other unmatched cells will generate null values in this column."]}),"\n",(0,t.jsx)(i.h3,{id:"add-columns-from-reconciled-values",children:"Add columns from reconciled values"}),"\n",(0,t.jsxs)(i.p,{children:["If the reconciliation service supports ",(0,t.jsx)(i.a,{href:"https://reconciliation-api.github.io/testbench/",children:"data extension"}),", then you can augment your reconciled data with new columns using ",(0,t.jsx)("span",{class:"menuItems",children:"Edit column"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Add columns from reconciled values..."}),"."]}),"\n",(0,t.jsx)(i.p,{children:"For example, if you have a column of chemical elements identified by name, you can fetch categorical information about them such as their atomic number and their element symbol:"}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"A screenshare of elements fetching related information.",src:n(37828).Z+""})}),"\n",(0,t.jsxs)(i.p,{children:["Once you have chosen reconciliation matches for your cells, selecting ",(0,t.jsx)("span",{class:"menuItems",children:"Add column from reconciled values..."})," will bring up a window to choose which related information you\u2019d like to import into new columns. You can manually enter desired properties, or select from a list of suggestions."]}),"\n",(0,t.jsx)(i.p,{children:"The quality of the suggested properties will depend on how you have reconciled your data beforehand: reconciling against a specific type will provide you with the associated properties of that type. For example, GND suggests elements about the \u201cpeople\u201d type after you've reconciled with it, such as their parents, native languages, children, etc."}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"A screenshot of available properties from GND.",src:n(5340).Z+""})}),"\n",(0,t.jsx)(i.p,{children:"If you have left any values unreconciled in your column, you will see \u201c<not reconciled>\u201d in the preview. These will generate blank cells if you continue with the column addition process."}),"\n",(0,t.jsx)(i.p,{children:"This process may pull more than one property per row in your data (such as multiple occupations), so you may need to switch into records mode after you've added columns."}),"\n",(0,t.jsx)(i.h3,{id:"add-columns-by-fetching-urls",children:"Add columns by fetching URLs"}),"\n",(0,t.jsxs)(i.p,{children:["If the reconciliation service cannot extend data, look for a generic web API for that data source, or a structured URL that points to their dataset entities via unique IDs (such as \u201c",(0,t.jsx)(i.a,{href:"https://viaf.org/viaf/000000%E2%80%9D",children:"https://viaf.org/viaf/000000\u201d"}),")."," You can use the ",(0,t.jsx)("span",{class:"menuItems",children:"Edit column"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:(0,t.jsx)(i.a,{href:"columnediting#add-column-by-fetching-urls",children:"Add column by fetching URLs"})})," operation to call this API or URL with the IDs obtained from the reconciliation process. This will require using ",(0,t.jsx)(i.a,{href:"expressions",children:"expressions"}),"."]}),"\n",(0,t.jsx)(i.p,{children:"You may not want to pull the entire HTML content of the pages at the ends of these URLs, so look to see whether the service offers a metadata endpoint, such as JSON-formatted data. You can either use a column of IDs, or you can pull the ID from each matched cell during the fetching process."}),"\n",(0,t.jsxs)(i.p,{children:["For example, if you have reconciled artists to the Getty's ULAN, and ",(0,t.jsx)(i.a,{href:"#add-entity-identifiers-column",children:"have their unique ULAN IDs as a column"}),", you can generate a new column of JSON-formatted data by using ",(0,t.jsx)("span",{class:"menuItems",children:"Add column by fetching URLs"})," and entering the GREL expression ",(0,t.jsx)(i.code,{children:'"http://vocab.getty.edu/" + value + ".json"'}),". For this service, the unique IDs are formatted \u201culan/000000\u201d and so the generated URLs look like \u201c",(0,t.jsx)(i.a,{href:"http://vocab.getty.edu/ulan/000000.json%E2%80%9D",children:"http://vocab.getty.edu/ulan/000000.json\u201d"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["Alternatively, you can insert the ID directly from the matched column's reconciliation variables, using a GREL expression like ",(0,t.jsx)(i.code,{children:"\u201chttp://vocab.getty.edu/\u201d + cell.recon.match.id + \u201c.json\u201d"})," instead."]}),"\n",(0,t.jsxs)(i.p,{children:["Remember to set an appropriate throttle and to refer to the service documentation to ensure your compliance with their terms. See ",(0,t.jsx)(i.a,{href:"columnediting#add-column-by-fetching-urls",children:"the section about this operation"})," to learn more about the fetching process."]}),"\n",(0,t.jsx)(i.h2,{id:"keep-all-the-suggestions-made",children:"Keep all the suggestions made"}),"\n",(0,t.jsxs)(i.p,{children:["To generate a list of each suggestion made, rather than only the best candidate, you can use a ",(0,t.jsx)(i.a,{href:"expressions#GREL",children:"GREL expression"}),". Go to ",(0,t.jsx)("span",{class:"menuItems",children:"Edit column"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Add column based on this column"}),". To create a list of all the possible matches, use something like"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'forEach(cell.recon.candidates,c,c.name).join(", ")\n'})}),"\n",(0,t.jsx)(i.p,{children:"To get the unique identifiers of these matches instead, use"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'forEach(cell.recon.candidates,c,c.id).join(", ")\n'})}),"\n",(0,t.jsx)(i.p,{children:"This information is stored as a string, without any attached reconciliation information."}),"\n",(0,t.jsx)(i.h2,{id:"writing-reconciliation-expressions",children:"Writing reconciliation expressions"}),"\n",(0,t.jsx)(i.p,{children:"OpenRefine supplies a number of variables related specifically to reconciled values. These can be used in GREL and Jython expressions. For example, some of the reconciliation variables are:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"cell.recon.match.id"})," or ",(0,t.jsx)(i.code,{children:"cell.recon.match.name"})," for matched values"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"cell.recon.best.name"})," or ",(0,t.jsx)(i.code,{children:"cell.recon.best.id"})," for best-candidate values"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"cell.recon.candidates"})," for all listed candidates of each cell"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"cell.recon.judgment"})," (the values used in the \u201cjudgment\u201d facet)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"cell.recon.judgmentHistory"})," (the values used in the \u201cjudgment action timestamp\u201d facet)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"cell.recon.matched"})," (a \u201ctrue\u201d or \u201cfalse\u201d value)"]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["You can find out more in the ",(0,t.jsx)(i.a,{href:"expressions#reconciliaton-variables",children:"reconciliaton variables"})," section."]}),"\n",(0,t.jsx)(i.admonition,{title:"Make a copy of a reconciled column",type:"tip",children:(0,t.jsxs)(i.p,{children:["To make a copy of a reconciled column and all its contents (the entire recon object for each cell) into a new column, just use the GREL expression ",(0,t.jsx)(i.code,{children:"cell"})," only when using ",(0,t.jsx)("span",{class:"menuItems",children:"Edit column"})," \u2192 ",(0,t.jsx)("span",{class:"menuItems",children:"Add column based on this column"}),"."]})}),"\n",(0,t.jsx)(i.h2,{id:"exporting-reconciled-data",children:"Exporting reconciled data"}),"\n",(0,t.jsxs)(i.p,{children:["Once you have data that is reconciled to existing entities online, you may wish to export that data to a user-editable service such as Wikidata. See the section on ",(0,t.jsx)(i.a,{href:"wikibase/uploading",children:"uploading your edits to Wikidata or other Wikibase instances"})," for more information, or the section on ",(0,t.jsx)(i.a,{href:"exporting",children:"exporting"})," to see other formats OpenRefine can produce."]}),"\n",(0,t.jsxs)(i.p,{children:["You can share reconciled data in progress through a ",(0,t.jsx)(i.a,{href:"exporting#export-a-project",children:"project export or import"}),", with some preparation. The importing user needs to have the appropriate reconciliation services installed on their OpenRefine instance (by going to ",(0,t.jsx)("span",{class:"menuItems",children:"Start reconciling"})," and clicking on ",(0,t.jsx)("span",{class:"buttonLabels",children:"Add Standard Service..."}),") in advance of opening the project, in order to use candidate and match links. Otherwise, the links will be broken and the user will need to add the reconciliation service and re-reconcile the columns in question. ",(0,t.jsx)(i.a,{href:"wikibase/reconciling",children:"Wikidata"})," reconciliation data can be shared more easily as the service comes bundled with OpenRefine."]})]})}function d(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},78004:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcile-by-type-eef1aba15070af5481d7a18419abd6bd.png"},67371:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcile-with-property-f19d20e265a86739191b733142167921.png"},5340:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcileGND-902370c34918130eb35b834bae4f9bb2.png"},62739:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcileIDerror-5411afd91cd9694c32e062191c050d06.png"},60759:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcileParis-dd3d74a30c832ae23f778928098ff50b.gif"},37828:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcileelements-ef6479085c603f6c2b4b278f518a0d12.gif"},30867:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcilehover-a9fd6853e09716dfd7d81acb648e4203.png"},17197:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcilewindow-71c4183d69ae77ae09a37b17fd95cf04.png"},30089:(e,i,n)=>{n.d(i,{Z:()=>t});const t=n.p+"assets/images/reconcilewindow2-82c0c0cac0e5f354d50f94b9eccdea1d.png"},69018:(e,i,n)=>{n.d(i,{Z:()=>c,a:()=>o});var t=n(47768);const s={},a=t.createContext(s);function o(e){const i=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:i},e.children)}}}]);